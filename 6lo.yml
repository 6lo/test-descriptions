strings:
  - &nohc Header compression is disabled on both EUT1 and EUT2
  - &hc (6LoWPAN:) Header compression is enabled on both EUT1 and EUT2
  - &e64 EUT1 and EUT2 are configured to use EUI-64
  - &e16 EUT1 and EUT2 are configured to use 16-bit short address
  - &e64o EUT1 and EUT2 are configured to use EUI-64 or other long address
  - &e16o EUT1 and EUT2 are configured to use 16-bit or other short address
  - &e6416 EUT1 is configured to use EUI-64 and EUT2 is configured to use 16-bit short address
  - &e1664 EUT1 is configured to use 16-bit short address and EUT2 is configured to use EUI-64
  - &h64 EUT1 and EUT2 are configured with a default hop limit of 64
  - &h63 EUT1 and EUT2 are configured with a default hop limit of 63
  - &nn Node-Node
  - &hr Host-6LR
  - &bac 6LBR-2Host, bus topology
  - &longtec 6LoWPAN, BTLE, DECT
  - &shorttec 6LoWPAN, 6LoBAC, NFC, LoWPANz
  - &hchr (6LoWPAN:) Header compression is enabled on both Host and Router
  - &coaping A CoAP ping server is installed on port 5683 of the host
  - &coaping6 A CoAP ping server is installed on port 61616 of the host
  - &host64 Host is configured to use EUI-64 address
  - &host16 Host is configured to use 16-bit address
  - &registered Host is up and registered its global address with the Router
  - &hl10 In IP_HC, HLIM (HL) is 10 and the hop limit field is compressed away
  - &hl00 In IP_HC, HLIM (HL) is 00 and the hop limit field is carried in-line
  - &replyhl The Echo Reply message might use a different hop limit in some implementations, then the HLIM value might also be different.



TD_6Lo_FORMAT_01:
  obj: Check that EUTs correctly handle uncompressed 6LoWPAN packets (EUI-64 link-local)
  cfg: *nn
  lev: basic
  tec: 6LoWPAN only
  ref: RFC 4944 5.1, 8; RFC 6775 5.6
  pre:
    - *nohc
    - *e64
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
    - c:
      - EUT1 sends an uncompressed 6LoWPAN packet containing the Echo Request message to EUT2's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Both source and destination addresses are EUI-64 link-local
    - v: EUT2 receives the Echo Request message  from EUT1
    - c:
      - EUT2 sends an uncompressed 6LoWPAN packet containing the Echo Reply message to EUT1's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Both source and destination addresses are EUI-64 link-local
    - v: EUT1 receives the Echo Reply message from EUT2
    - c: The data received in the echo reply message is identical to that sent in EUT1's echo request message

TD_6Lo_FORMAT_07:
  obj: Check that EUTs correctly handle uncompressed 6LoWPAN packets (EUI-64 to 16-bit short link-local)
  cfg: *nn
  lev: basic
  tec: 6LoWPAN only
  ref: RFC 4944 5.1, 8; RFC 6775 5.6
  pre:
    - *nohc
    - *e6416
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
    - c:
      - EUT1 sends an uncompressed 6LoWPAN packet containing the Echo Request message to EUT2's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Source address is EUI-64 link-local
      - Destination address is 16-bit short link-local
    - v: EUT2 receives the Echo Request message  from EUT1
    - c:
      - EUT2 sends an uncompressed 6LoWPAN packet containing the Echo Reply message to EUT1's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Source address is 16-bit short link-local
      - Destination address is EUI-64 link-local
    - v: EUT1 receives the Echo Reply message from EUT2
    - c: The data received in the echo reply message is identical to that sent in EUT1's echo request message

TD_6Lo_FORMAT_06:
  obj: Check that EUTs correctly handle uncompressed 6LoWPAN multicast to all-nodes (EUI-64 link-local)
  cfg: *nn
  lev: basic
  tec: 6LoWPAN only
  ref: RFC 4944 5.1, 8; RFC 6775 5.6
  pre:
    - *nohc
    - *e64
  seq:
    - s: EUT1 initiates an echo request to the link-local all-nodes multicast address (FF02::1)  (ICMP payload = 4 bytes, total IPv6 size 52 bytes)
    - c: EUT1 sends an uncompressed 6LoWPAN packet containing the Echo Request message to EUT2
    - c: Dispatch value in 6LowPAN packet is “01000001”
    - v: EUT2 receives the Echo Request message  from EUT1
    - c: EUT2 sends an uncompressed 6LoWPAN packet containing the Echo Reply message to EUT1
    - c: Dispatch value in 6LowPAN packet is “01000001”
    - v: EUT1 receives the Echo Reply message from EUT2
    - c: The data in the echo reply message is identical to that in the echo request message


TD_6Lo_ND_01:
  obj: Check that a host is able to register its global IPv6 address (EUI-64 or other long address)
  cfg: *hr
  lev: basic
  tec: *longtec
  ref: RFC 6775 10.2
  pre: &prend01
    - *hchr
    - Host is configured to use EUI-64 or other long address
  seq:
    - s: Initialize the network interface of the Host
    - c: The Host sends a Router Solicitation to all-routers multicast address with SLLAO (EUI-64 or other long address). Source = link local based on EUI-64 or other long address
    - v: The Router receives the Router Solicitation from the host.
    - c:
      - The Router sends a unicast Router Advertisement containing PIO and optionally 6COs to the host.
      - Link local addresses are used.
      - The L bit is not set.
    - v: The host receives the Router Advertisement from the router
    - c: The host configures its tentative global IPv6 address based on the PIO information in RA from the Router (EUI-64 or other long address)
    - c: The host registers its tentative address by sending a unicast Neighbor Solicitation containing ARO and SLLAO. Source = GP64
    - v: The Router receives the Neighbor Solicitation from the host.
    - c: The Router sends a Neighbor Advertisement with ARO Status set to 0 (Dest = GP64)
    - v: The host updates the status of the tentative address
    - s:
      - The Router initiates an echo request to the Host's new global address, using its own global address as the source
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: The Router sends a 6Lo packet containing the Echo Request message to the Host
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - v: The Host receives the Echo Request message from the Router
    - c: The Host sends a 6Lo packet containing the Echo Reply message to the Router
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - v: The Router receives the Echo Reply message from the Host
  not: *replyhl
  big: yes

TD_6Lo_ND_06:
  obj: Check host behavior under multiple prefixes (EUI-64 or other long address)
  cfg: *hr
  lev: advanced
  tec: *longtec
  ref: RFC 4861 3.1
  pre:
    - *hchr
    - Host is configured to use EUI-64 or other long address
    - Router is configured with multiple prefixes
  seq:
    - s: Initialize the network interface of the Host
    - c: The Host sends a Router Solicitation to all-routers multicast address with SLLAO (EUI-64 or other long address). Source = link local based on EUI-64 or other long address
    - v: The Router receives the Router Solicitation from the host.
    - c:
      - The Router sends a unicast Router Advertisement containing PIO with multiple prefixes and optionally 6COs to the host.
      - Link local addresses are used.
      - The L bit is not set.
    - v: The host receives the Router Advertisement from the router
    - c: The host configures a number of tentative global IPv6 address based on the PIO information in RA from the Router (EUI-64 or other long address)
    - c: The host registers its tentative addresses by sending unicast Neighbor Solicitations containing ARO and SLLAO. Source = GP64
    - v: The Router receives the Neighbor Solicitations from the host.
    - c: The Router sends Neighbor Advertisements with Status set to 0 (Dest = GP64)
    - v: The host updates the status of the tentative addresses
    - s:
      - The Router initiates an echo request to one of the Host's new global addresses, using the appropriate own global address as the source
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: The Router sends a 6Lo packet containing the Echo Request message to the Host
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - v: The Host receives the Echo Request message from the Router
    - c: The Host sends a 6Lo packet containing the Echo Reply message to the Router
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - v: The Router receives the Echo Reply message from the Host
  not:
    - Optional, as not all 6LRs and hosts allow multiple prefixes
    - *replyhl
  big: yes



TD_6Lo_HC_01:
  obj: Check that EUTs correctly handle compressed 6Lo packets (EUI-64 or other long address link-local, hop limit=64)
  cfg: *nn
  lev: basic
  tec: *longtec
  ref: RFC 6282 section 3; RFC 6775 5.6
  pre:
    - *hc
    - *e64o
    - *h64
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: EUT1 sends a compressed 6Lo packet containing the Echo Request message to EUT2
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT2 receives the Echo Request message from EUT1
    - c: EUT2 sends a compressed 6Lo packet containing the Echo Reply message to EUT1
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT1 receives the Echo Reply message from EUT2
  not:
    - The feature tests check that best compression is used (but this is not a requirement for interoperability)
    - *replyhl



TD_6Lo_HC_03:
  obj: Check that EUTs correctly handle compressed 6Lo packets (EUI-64 or other long address link-local, hop limit=63)
  cfg: *nn
  lev: basic
  tec: *longtec
  ref: RFC 6282 section 3; RFC 6775 5.6
  pre:
    - *hc
    - *e64o
    - *h63
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 63, no traffic class or flow label is being used
    - c: EUT1 sends a compressed 6Lo packet containing the Echo Request message to EUT2
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl00
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT2 receives the Echo Request message from EUT1
    - c: EUT2 sends a compressed 6Lo packet containing the Echo Reply message to EUT1
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl00
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT1 receives the Echo Reply message from EUT2
  not:
    - The feature tests check that best compression is used (but this is not a requirement for interoperability)
    - *replyhl




TD_6Lo_HC_09:
  obj: Check that EUTs correctly handle compressed 6LoWPAN packets (EUI-64 or other long address to 16-bit or other short address link-local, hop limit=64)
  cfg: *nn
  lev: basic
  tec: 6LoWPAN only
  ref: RFC 6282 section 3; RFC 6775 5.6
  pre:
    - *hc
    - *e6416
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: EUT1 sends a compressed 6LoWPAN packet containing the Echo Request message to EUT2
    - c: Dispatch value in 6LowPAN packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT2 receives the Echo Request message from EUT1
    - c: EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1
    - c: Dispatch value in 6LowPAN packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT1 receives the Echo Reply message from EUT2
  not:
    - The feature tests check that best compression is used (but this is not a requirement for interoperability)
    - *replyhl




TD_6Lo_HC_05:
  obj: Check that EUTs correctly handle compressed UDP packets (EUI-64 or other long address, server port 5683)
  cfg: *hr
  lev: basic
  tec: *longtec
  ref: RFC 6282, 4.3
  pre:
    - *hchr
    - *host64
    - *coaping
  seq:
    - s:
      - 6LR initiates a CoAP Ping request to Host's CoAP Ping server
    - c: 6LR sends a 6Lo packet containing the CoAP Ping message to Host
    - f: NH is set, NHC is 111100x0, the source port is compressed to 8 bits (x=1) or uncompressed (x=0), the destination port is uncompressed 5683
    - v: Host receives the CoAP Ping message from 6LR
    - c: Host sends a 6Lo packet containing the CoAP Reset message to 6LR
    - f: NH is set, NHC is 1111000x, the source port is uncompressed 5683, the destination port is compressed to 8 bits (x=1) or uncompressed (x=0)
    - v: 6LR receives the CoAP Reset message from Host
  not: The feature tests check that best compression is used (but this is not a requirement for interoperability)




TD_6Lo_HC_07:
  obj: Check that EUTs correctly handle compressed UDP packets (EUI-64 or other long address, server port 61616)
  cfg: *hr
  lev: basic
  tec: *longtec
  ref: RFC 6282, 4.3
  pre:
    - *hchr
    - *host64
    - *coaping6
  seq:
    - s:
      - 6LR initiates a CoAP Ping request to Host's CoAP Ping server
    - c: 6LR sends a 6Lo packet containing the CoAP Ping message to Host
    - f: NH is set, NHC is 111100x1, the destination port is compressed to 4 bits of 0000 (x=1) or 8 bits of 0xb0 (x=0)
    - v: Host receives the CoAP Ping message from 6LR
    - c: Host sends a 6Lo packet containing the CoAP Reset message to 6LR
    - f: NH is set, NHC is 1111001x, the source port is compressed to 4 bits of 0000 (x=1) or 8 bits of 0xb0 (x=0)
    - v: 6LR receives the CoAP Reset message from Host
  not: The feature tests check that best compression is used (but this is not a requirement for interoperability)




TD_6Lo_HC_11:
  obj: Check that EUTs correctly handle NH=0 compressed TCP packets (EUI-64 or other long address)
  cfg: *hr
  lev: advanced
  tec: *longtec
  ref: RFC 6282, 3.1.1
  pre:
    - *hchr
    - *host64
    - A TCP server (e.g., a HTTP server) is installed on port 80 of the host
  seq:
    - s:
      - 6LR initiates a TCP SYN request (connect) to Host's TCP server
    - c: 6LR sends a 6Lo packet containing the TCP SYN packet to Host
    - c: NH=0
    - v: Host receives the TCP SYN packet from 6LR
    - c: Host sends a 6Lo packet containing a TCP SYN/ACK message to 6LR
    - c: NH=0
    - v: 6LR receives the TCP SYN/ACK from Host
  not:
    - Optional, as not all 6LRs and hosts support TCP


TD_6Lo_ND_HC_01:
  obj: Check that EUTs make use of context 0 (EUI-64 or other long address)
  cfg: *hr
  lev: advanced
  tec: *longtec
  ref: RFC 6775 5.4, RFC 6282 3.1.1
  pre:
    - *hc
    - *e64o
    - *h64
  seq:
    - s: Host is set up with 6LR and receives context 0 for the global prefix
    - s:
      - EUT1 initiates an echo request to EUT2's GP64 address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: EUT1 sends a 6Lo packet containing the Echo Request message to EUT2
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=01/11)
    - f: The context identifier extension is not present (CID = 0)
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - v: EUT2 receives the Echo Request message from EUT1
    - c: EUT2 sends a compressed 6Lo packet containing the Echo Reply message to EUT1
    - f: *hl10
    - f: The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=01/11)
    - f: The context identifier extension is not present (CID = 0)
    - c: Dispatch value in 6Lo packet is “011TFxHL”
  not:
    - The feature tests check that good compression is used (but this is not a requirement for interoperability)
    - *replyhl

TD_6Lo_ND_HC_03:
  obj: Check that EUTs make use of context ≠ 0 (EUI-64 or other long address)
  cfg: *hr
  lev: advanced
  tec: *longtec
  ref: RFC 6775 5.4, RFC 6282 3.1.2
  pre:
    - *hc
    - *e64o
    - *h64
  seq:
    - s: Host is set up with 6LR and receives context ≠ 0 for the global prefix
    - s:
      - EUT1 initiates an echo request to EUT2's GP64 address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: EUT1 sends a 6Lo packet containing the Echo Request message to EUT2
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=01/11)
    - c: A Context Identifier Extension (CID) is used for this
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - v: EUT2 receives the Echo Request message from EUT1
    - c: EUT2 sends a compressed 6Lo packet containing the Echo Reply message to EUT1
    - f: *hl10
    - f: The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=01/11)
    - c: A Context Identifier Extension (CID) is used for this
    - c: Dispatch value in 6Lo packet is “011TFxHL”
  not:
    - The feature tests check that good compression is used (but this is not a requirement for interoperability)
    - *replyhl



TD_6Lo_FORMAT_02:
  obj: Check that EUTs correctly handle uncompressed 6LoWPAN packets (16-bit short link-local)
  cfg: *nn
  lev: basic
  tec: 6LoWPAN only
  ref: RFC 4944 5.1, 8; RFC 6775 5.6
  pre:
    - *nohc
    - *e16
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
    - c:
      - EUT1 sends an uncompressed 6LoWPAN packet containing the Echo Request message to EUT2's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Both source and destination addresses are 16-bit short link-local
    - v: EUT2 receives the Echo Request message  from EUT1
    - c:
      - EUT2 sends an uncompressed 6LoWPAN packet containing the Echo Reply message to EUT1's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Both source and destination addresses are 16-bit short link-local
    - v: EUT1 receives the Echo Reply message from EUT2
    - c: The data received in the echo reply message is identical to that sent in EUT1's echo request message

TD_6Lo_FORMAT_08:
  obj: Check that EUTs correctly handle uncompressed 6LoWPAN packets (16-bit short to EUI-64 link-local)
  cfg: *nn
  lev: basic
  tec: 6LoWPAN only
  ref: RFC 4944 5.1, 8; RFC 6775 5.6
  pre:
    - *nohc
    - *e1664
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
    - c:
      - EUT1 sends an uncompressed 6LoWPAN packet containing the Echo Request message to EUT2's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Source address is 16-bit short link-local
      - Destination address is EUI-64 link-local
    - v: EUT2 receives the Echo Request message  from EUT1
    - c:
      - EUT2 sends an uncompressed 6LoWPAN packet containing the Echo Reply message to EUT1's link-local address
      - Dispatch value in 6LowPAN packet is “01000001”
      - Source address is EUI-64 link-local
      - Destination address is 16-bit short link-local
    - v: EUT1 receives the Echo Reply message from EUT2
    - c: The data received in the echo reply message is identical to that sent in EUT1's echo request message

TD_6Lo_FORMAT_05:
  obj: Check that EUTs correctly handle uncompressed 6LoWPAN multicast to all-nodes (16-bit short link-local)
  cfg: *nn
  lev: basic
  tec: 6LoWPAN only
  ref: RFC 4944 5.1, 8; RFC 6775 5.6
  pre:
    - *nohc
    - *e16
  seq:
    - s: EUT1 initiates an echo request to the link-local all-nodes multicast address (FF02::1)  (ICMP payload = 4 bytes, total IPv6 size 52 bytes)
    - c: EUT1 sends an uncompressed 6LoWPAN packet containing the Echo Request message to EUT2
    - c: Dispatch value in 6LowPAN packet is “01000001”
    - v: EUT2 receives the Echo Request message  from EUT1
    - c: EUT2 sends an uncompressed 6LoWPAN packet containing the Echo Reply message to EUT1
    - c: Dispatch value in 6LowPAN packet is “01000001”
    - v: EUT1 receives the Echo Reply message from EUT2
    - c: The data in the echo reply message is identical to that in the echo request message


TD_6Lo_ND_02:
  obj: Check that a host is able to register its global IPv6 address (16-bit or other short address)
  cfg: *hr
  lev: basic
  tec: *shorttec
  ref: RFC 6775 10.2
  pre: &prend01
    - *hchr
    - Host is configured to use 16-bit or other short address
  seq:
    - s: Initialize the network interface of the Host
    - c: The Host sends a Router Solicitation to all-routers multicast address with SLLAO (EUI-64 or other long address for 6LoWPAN, 16-bit or other short address elsewhere). Source = link local based on EUI-64 or other long address for 6LoWPAN, 16-bit or other short address elsewhere
    - v: The Router receives the Router Solicitation from the host.
    - c:
      - The Router sends a unicast Router Advertisement containing PIO and optionally 6COs to the host.
      - Link local addresses are used.
      - The L bit is set (6LoBAC); the L bit is not set (NFC, LoWPANz, 6LoWPAN).
    - v: The host receives the Router Advertisement from the router
    - c: The host configures its tentative global IPv6 address based on the PIO information in RA from the Router (16-bit or other short address)
    - c: The host registers its tentative address by sending a unicast Neighbor Solicitation containing ARO and SLLAO. Source = GP16
    - v: The Router receives the Neighbor Solicitation from the host.
    - c: The Router sends a Neighbor Advertisement with ARO Status set to 0 (Dest = GP16)
    - v: The host updates the status of the tentative address
    - s:
      - The Router initiates an echo request to the Host's new global address, using its own global address as the source
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: The Router sends a 6Lo packet containing the Echo Request message to the Host
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - v: The Host receives the Echo Request message from the Router
    - c: The Host sends a 6Lo packet containing the Echo Reply message to the Router
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - v: The Router receives the Echo Reply message from the Host
  not: *replyhl
  big: yes

TD_6Lo_ND_07:
  obj: Check host behavior under multiple prefixes (16-bit or other short address)
  cfg: *hr
  lev: advanced
  tec: *shorttec
  ref: RFC 4861 3.1
  pre:
    - *hchr
    - Host is configured to use 16-bit or other short address
    - Router is configured with multiple prefixes
  seq:
    - s: Initialize the network interface of the Host
    - c: The Host sends a Router Solicitation to all-routers multicast address with SLLAO (EUI-64 or other long address for 6LoWPAN, 16-bit or other short address elsewhere). Source = link local based on EUI-64 or other long address for 6LoWPAN, 16-bit or other short address elsewhere
    - v: The Router receives the Router Solicitation from the host.
    - c:
      - The Router sends a unicast Router Advertisement containing PIO with multiple prefixes and optionally 6COs to the host.
      - Link local addresses are used.
      - The L bit is set (6LoBAC); the L bit is not set (NFC, LoWPANz, 6LoWPAN).
    - v: The host receives the Router Advertisement from the router
    - c: The host configures a number of tentative global IPv6 address based on the PIO information in RA from the Router (16-bit or other short address)
    - c: The host registers its tentative addresses by sending unicast Neighbor Solicitations containing ARO and SLLAO. Source = GP16
    - v: The Router receives the Neighbor Solicitations from the host.
    - c: The Router sends Neighbor Advertisements with Status set to 0 (Dest = GP16)
    - v: The host updates the status of the tentative addresses
    - s:
      - The Router initiates an echo request to one of the Host's new global addresses, using the appropriate own global address as the source
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: The Router sends a 6Lo packet containing the Echo Request message to the Host
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - v: The Host receives the Echo Request message from the Router
    - c: The Host sends a 6Lo packet containing the Echo Reply message to the Router
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - v: The Router receives the Echo Reply message from the Host
  not:
    - Optional, as not all 6LRs and hosts allow multiple prefixes
    - *replyhl
  big: yes



TD_6Lo_HC_02:
  obj: Check that EUTs correctly handle compressed 6Lo packets (16-bit or other short address link-local, hop limit=64)
  cfg: *nn
  lev: basic
  tec: *shorttec
  ref: RFC 6282 section 3; RFC 6775 5.6
  pre:
    - *hc
    - *e16o
    - *h64
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: EUT1 sends a compressed 6Lo packet containing the Echo Request message to EUT2
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT2 receives the Echo Request message from EUT1
    - c: EUT2 sends a compressed 6Lo packet containing the Echo Reply message to EUT1
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT1 receives the Echo Reply message from EUT2
  not:
    - The feature tests check that best compression is used (but this is not a requirement for interoperability)
    - *replyhl



TD_6Lo_HC_04:
  obj: Check that EUTs correctly handle compressed 6Lo packets (16-bit or other short address link-local, hop limit=63)
  cfg: *nn
  lev: basic
  tec: *shorttec
  ref: RFC 6282 section 3; RFC 6775 5.6
  pre:
    - *hc
    - *e16o
    - *h63
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 63, no traffic class or flow label is being used
    - c: EUT1 sends a compressed 6Lo packet containing the Echo Request message to EUT2
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl00
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT2 receives the Echo Request message from EUT1
    - c: EUT2 sends a compressed 6Lo packet containing the Echo Reply message to EUT1
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl00
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT1 receives the Echo Reply message from EUT2
  not:
    - The feature tests check that best compression is used (but this is not a requirement for interoperability)
    - *replyhl




TD_6Lo_HC_10:
  obj: Check that EUTs correctly handle compressed 6LoWPAN packets (16-bit or other short address to EUI-64 or other long address link-local, hop limit=64)
  cfg: *nn
  lev: basic
  tec: 6LoWPAN only
  ref: RFC 6282 section 3; RFC 6775 5.6
  pre:
    - *hc
    - *e1664
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: EUT1 sends a compressed 6LoWPAN packet containing the Echo Request message to EUT2
    - c: Dispatch value in 6LowPAN packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT2 receives the Echo Request message from EUT1
    - c: EUT2 sends a compressed 6LoWPAN packet containing the Echo Reply message to EUT1
    - c: Dispatch value in 6LowPAN packet is “011TFxHL”
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: In IP_HC, SAC=0, SAM=11; DAC=0; DAM=11
    - v: EUT1 receives the Echo Reply message from EUT2
  not:
    - The feature tests check that best compression is used (but this is not a requirement for interoperability)
    - *replyhl




TD_6Lo_HC_06:
  obj: Check that EUTs correctly handle compressed UDP packets (16-bit or other short address, server port 5683)
  cfg: *hr
  lev: basic
  tec: *shorttec
  ref: RFC 6282, 4.3
  pre:
    - *hchr
    - *host16
    - *coaping
  seq:
    - s:
      - 6LR initiates a CoAP Ping request to Host's CoAP Ping server
    - c: 6LR sends a 6Lo packet containing the CoAP Ping message to Host
    - f: NH is set, NHC is 111100x0, the source port is compressed to 8 bits (x=1) or uncompressed (x=0), the destination port is uncompressed 5683
    - v: Host receives the CoAP Ping message from 6LR
    - c: Host sends a 6Lo packet containing the CoAP Reset message to 6LR
    - f: NH is set, NHC is 1111000x, the source port is uncompressed 5683, the destination port is compressed to 8 bits (x=1) or uncompressed (x=0)
    - v: 6LR receives the CoAP Reset message from Host
  not: The feature tests check that best compression is used (but this is not a requirement for interoperability)




TD_6Lo_HC_08:
  obj: Check that EUTs correctly handle compressed UDP packets (16-bit or other short address, server port 61616)
  cfg: *hr
  lev: basic
  tec: *shorttec
  ref: RFC 6282, 4.3
  pre:
    - *hchr
    - *host16
    - *coaping6
  seq:
    - s:
      - 6LR initiates a CoAP Ping request to Host's CoAP Ping server
    - c: 6LR sends a 6Lo packet containing the CoAP Ping message to Host
    - f: NH is set, NHC is 111100x1, the destination port is compressed to 4 bits of 0000 (x=1) or 8 bits of 0xb0 (x=0)
    - v: Host receives the CoAP Ping message from 6LR
    - c: Host sends a 6Lo packet containing the CoAP Reset message to 6LR
    - f: NH is set, NHC is 1111001x, the source port is compressed to 4 bits of 0000 (x=1) or 8 bits of 0xb0 (x=0)
    - v: 6LR receives the CoAP Reset message from Host
  not: The feature tests check that best compression is used (but this is not a requirement for interoperability)




TD_6Lo_HC_12:
  obj: Check that EUTs correctly handle NH=0 compressed TCP packets (16-bit or other short address)
  cfg: *hr
  lev: advanced
  tec: *shorttec
  ref: RFC 6282, 3.1.1
  pre:
    - *hchr
    - *host16
    - A TCP server (e.g., a HTTP server) is installed on port 80 of the host
  seq:
    - s:
      - 6LR initiates a TCP SYN request (connect) to Host's TCP server
    - c: 6LR sends a 6Lo packet containing the TCP SYN packet to Host
    - c: NH=0
    - v: Host receives the TCP SYN packet from 6LR
    - c: Host sends a 6Lo packet containing a TCP SYN/ACK message to 6LR
    - c: NH=0
    - v: 6LR receives the TCP SYN/ACK from Host
  not:
    - Optional, as not all 6LRs and hosts support TCP


TD_6Lo_ND_HC_02:
  obj: Check that EUTs make use of context 0 (16-bit or other short address)
  cfg: *hr
  lev: advanced
  tec: *shorttec
  ref: RFC 6775 5.4, RFC 6282 3.1.1
  pre:
    - *hc
    - *e16o
    - *h64
  seq:
    - s: Host is set up with 6LR and receives context 0 for the global prefix
    - s:
      - EUT1 initiates an echo request to EUT2's GP16 address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: EUT1 sends a 6Lo packet containing the Echo Request message to EUT2
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=10/11)
    - f: The context identifier extension is not present (CID = 0)
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - v: EUT2 receives the Echo Request message from EUT1
    - c: EUT2 sends a compressed 6Lo packet containing the Echo Reply message to EUT1
    - f: *hl10
    - f: The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=10/11)
    - f: The context identifier extension is not present (CID = 0)
    - c: Dispatch value in 6Lo packet is “011TFxHL”
  not:
    - The feature tests check that good compression is used (but this is not a requirement for interoperability)
    - *replyhl

TD_6Lo_ND_HC_04:
  obj: Check that EUTs make use of context ≠ 0 (16-bit or other short address)
  cfg: *hr
  lev: advanced
  tec: *shorttec
  ref: RFC 6775 5.4, RFC 6282 3.1.2
  pre:
    - *hc
    - *e16o
    - *h64
  seq:
    - s: Host is set up with 6LR and receives context ≠ 0 for the global prefix
    - s:
      - EUT1 initiates an echo request to EUT2's GP16 address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
      - Hop Limit is 64, no traffic class or flow label is being used
    - c: EUT1 sends a 6Lo packet containing the Echo Request message to EUT2
    - f: In IP_HC, TF is 11 and the ecn, dscp and flow label fields are compressed away
    - f: *hl10
    - f: The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=10/11)
    - c: A Context Identifier Extension (CID) is used for this
    - c: Dispatch value in 6Lo packet is “011TFxHL”
    - v: EUT2 receives the Echo Request message from EUT1
    - c: EUT2 sends a compressed 6Lo packet containing the Echo Reply message to EUT1
    - f: *hl10
    - f: The compression makes use of the global prefix (SAC/DAC = 1, SAM/DAM=10/11)
    - c: A Context Identifier Extension (CID) is used for this
    - c: Dispatch value in 6Lo packet is “011TFxHL”
  not:
    - The feature tests check that good compression is used (but this is not a requirement for interoperability)
    - *replyhl





TD_6Lo_FORMAT_03:
  obj: Check that EUTs correctly handle uncompressed 6LoWPAN fragmented packets
  cfg: *nn
  lev: basic
  tec: 6LoWPAN only
  ref: RFC 4944 5.1, 5.3; RFC 6775 5.6
  pre:
    -   *nohc
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 253 bytes, total IPv6 size 301 bytes
    - c:
      - EUT1 sends a sequence of uncompressed 6LoWPAN packets containing the Echo Request fragments to EUT2
      - "EUT1 correctly fragments the Echo Request:"
      - a 6LoWPAN FRAG1 header (dispatch 11000xxx) is included in the first packet
      - a 6LoWPAN FRAGN header (dispatch 11100xxx) is included in all following packets
      - the offsets form a contiguous sequence
      - all fragments except the last one must be multiples of 8 bytes
    - v: EUT2 reassembles correctly the fragments and receives the Echo Request message from EUT1
    - c:
      - EUT2 sends a sequence of uncompressed 6LoWPAN packets containing the Echo Reply message to EUT1
      - "EUT1 correctly fragments the Echo Reply:"
      - a 6LoWPAN FRAG1 header (dispatch 11000xxx) is included in the first packet
      - a 6LoWPAN FRAGN header (dispatch 11100xxx) is included in all following packets
      - the offsets form a contiguous sequence
      - all fragments except the last one must be multiples of 8 bytes
      - The data in the echo reply message packets is identical to that sent in the echo request message packets
    - v: EUT1 correctly reassembles the fragments and receives the Echo Reply message from EUT2
    - v: The data in the received echo reply message is identical to that sent in the echo request message



TD_6Lo_FORMAT_04:
  obj: Check that EUTs correctly handle maximum size uncompressed 6LoWPAN fragmented packets
  cfg: *nn
  lev: basic
  tec: 6LoWPAN only
  ref: RFC 4944 5.1, 5.3; RFC 6775 5.6
  pre:
    -   *nohc
  seq:
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 1232 bytes, total IPv6 size 1280 bytes
    - c:
      - EUT1 sends a sequence of uncompressed 6LoWPAN packets containing the Echo Request fragments to EUT2
      - "EUT1 correctly fragments the Echo Request:"
      - a 6LoWPAN FRAG1 header (dispatch 11000xxx) is included in the first packet
      - a 6LoWPAN FRAGN header (dispatch 11100xxx) is included in all following packets
      - the offsets form a contiguous sequence
      - all fragments except the last one must be multiples of 8 bytes
    - v: EUT2 reassembles correctly the fragments and receives the Echo Request message from EUT1
    - c:
      - EUT2 sends a sequence of uncompressed 6LoWPAN packets containing the Echo Reply message to EUT1
      - "EUT1 correctly fragments the Echo Reply:"
      - a 6LoWPAN FRAG1 header (dispatch 11000xxx) is included in the first packet
      - a 6LoWPAN FRAGN header (dispatch 11100xxx) is included in all following packets
      - the offsets form a contiguous sequence
      - all fragments except the last one must be multiples of 8 bytes
      - The data in the echo reply message packets is identical to that sent in the echo request message packets
    - v: EUT1 correctly reassembles the fragments and receives the Echo Reply message from EUT2
    - v: The data in the received echo reply message is identical to that sent in the echo request message



TD_6Lo_FORMAT_09:
  obj: Check that EUTs correctly handle token passing/maintenance at 115.2 kbit/s and correctly handle a basic 6Lo packet (link-local)
  cfg: *bac
  lev: basic
  tec: 6LoBAC only
  ref: BACnet Clause 9 [10], BACnet MS/TP Conformance Test [11], RFC 6282, draft-ietf-6lobac
  pre:
    - EUTs conform to the MS/TP data link specification
    - EUTs are configured to use 115,200 bit/s
    - LBR is configured at address 0, Host 1 is at address 1, Host 2 is at address 2
    - Nmax_master is configured to 8 in all EUTs
  seq:
    - c:
      - LBR sends token to Host 1, Host 1 sends token to Host 2, Host 2 sends token to LBR
    - c:
      - Every 50 rotations of the token, Host 2 performs Poll for Master procedure
    - s:
      - EUT1 initiates an echo request to EUT2's link-local address
      - ICMP payload = 4 bytes, total IPv6 size 52 bytes
    - c:
      - EUT1 sends a 6LoBAC packet containing the Echo Request message to EUT2's link-local address
      - Both source and destination addresses are link-local
    - v: EUT2 receives the Echo Request message from EUT1 (may not be visible in EUR2 ➔ optional)
    - c:
      - EUT2 sends a 6LoBAC packet containing the Echo Reply message to EUT1's link-local address
      - Both source and destination addresses are link-local
    - v: EUT1 receives the Echo Reply message from EUT2
    - c: The data received in the echo reply message is identical to that sent in EUT1's echo request message

TD_6Lo_ND_03:
  obj: Check Host NUD behavior
  cfg: *hr
  lev: basic
  tec: all
  ref: RFC 6775 5.5
  pre:
    - *hchr
    - *registered
  seq:
    - s: Host sends a sequence of echo requests to 2001:db8::1
    - v: Host sends a unicast NS message to the 6LR to perform NUD

TD_6Lo_ND_04:
  obj: Check 6LR NUD behavior (ICMP version)
  cfg: *hr
  lev: basic
  tec: all
  ref: RFC 6775 5.5
  pre:
    - *hchr
    - *registered
  seq:
    - s: 6LR sends a sequence of echo requests to Host
    - s: After 10 seconds, echo reply function is disabled on host
    - v: 6LR sends a unicast NS message to the host to perform NUD
  not: Optional, as not all hosts allow disabling echo reply function

TD_6Lo_ND_05:
  obj: Check 6LR NUD behavior (UDP version)
  cfg: *hr
  lev: basic
  tec: all
  ref: RFC 6775 5.5
  pre:
    - *hchr
    - *coaping
    - *registered
  seq:
    - s: 6LR sends a sequence of CoAP pings to Host
    - s: After 10 seconds, CoAP server function is disabled on host
    - v: 6LR sends a unicast NS message to the host to perform NUD
  not: Optional, as not all hosts allow disabling CoAP server function
